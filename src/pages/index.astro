---
import { getCollection } from 'astro:content';
import DefaultLayout from '../layouts/DefaultLayout.astro';
import { SITE_TITLE, SITE_DESCRIPTION } from '../consts';

// 1. è·å–æœ€æ–°çš„3ç¯‡åšå®¢æ–‡ç«  (éªŒè¯ Content Collections é…ç½®æ˜¯å¦æ­£ç¡®)
// æ³¨æ„ï¼šè¿™é‡Œç”¨äº† chain methodï¼šè·å– -> è¿‡æ»¤è‰ç¨¿ -> æŒ‰æ—¶é—´å€’åº -> å–å‰3ä¸ª
const posts = (await getCollection('blogs'))
  .filter(post => !post.data.isDraft) // å‡è®¾ä½ åœ¨ schema é‡Œå®šä¹‰äº† isDraft
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
  .slice(0, 3);
---

<DefaultLayout title={SITE_TITLE} description={SITE_DESCRIPTION}>

    <section class="hero">
        <div class="hero-content">
            <h1>æ¬¢è¿æ¥åˆ°æˆ‘çš„æ•°å­—èŠ±å›­ ğŸŒ¿</h1>
            <p>
                è¿™æ˜¯åŸºäº Astro æ„å»ºçš„ä¸ªäººä¸»é¡µã€‚<br />
                è¿™é‡Œç”¨äºæµ‹è¯• Header çš„æ»šåŠ¨æ•ˆæœã€æ–‡ç« æ•°æ®çš„è¯»å–ä»¥åŠé¡µé¢å¸ƒå±€ã€‚
            </p>
            <div class="hero-actions">
                <a href="/blogs" class="btn btn-primary">æµè§ˆåšå®¢</a>
                <a href="https://github.com/yourusername" target="_blank" class="btn btn-outline">GitHub</a>
            </div>
        </div>
    </section>

    <section class="recent-posts">
        <h2>ğŸ”¥ æœ€æ–°æ–‡ç« </h2>
        <div class="post-grid">
            {posts.length > 0 ? (
                posts.map((post) => (
                    <a href={`/blogs/${post.slug}/`} class="post-card">
                        <h3>{post.data.title}</h3>
                        <p class="date">{post.data.pubDate.toLocaleDateString()}</p>
                        <p class="desc">{post.data.description}</p>
                    </a>
                ))
            ) : (
                <p>æš‚æ—¶è¿˜æ²¡æœ‰æ–‡ç« ï¼Œè¯·å» src/content/blogs ä¸‹æ·»åŠ ä¸€ç¯‡ markdown æ–‡ä»¶ã€‚</p>
            )}
        </div>
    </section>

    <section class="long-content-test">
        <h2>ğŸ“œ æ»šåŠ¨æµ‹è¯•åŒº</h2>
        <p>è¯·å°è¯•å‘ä¸‹æ»‘åŠ¨é¡µé¢ï¼Œè§‚å¯Ÿé¡¶éƒ¨çš„ Header å¯¼èˆªæ ï¼š</p>
        <ul>
            <li>Header æ˜¯å¦å›ºå®šåœ¨é¡¶éƒ¨ï¼Ÿ(Sticky)</li>
            <li>èƒŒæ™¯è‰²æ˜¯å¦ä»ç™½è‰²å˜æˆäº†æ·±è‰²ï¼Ÿ(JS è„šæœ¬ç”Ÿæ•ˆ)</li>
            <li>æ–‡å­—é¢œè‰²æ˜¯å¦å˜æˆäº†ç™½è‰²ï¼Ÿ(CSS :global ç”Ÿæ•ˆ)</li>
        </ul>

        {Array.from({ length: 10 }).map((_, i) => (
            <p style={{ opacity: 0.5 }}>
                Placeholder paragraph {i + 1}: Lorem ipsum dolor sit amet, consectetur adipiscing elit.
                Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
            </p>
        ))}
    </section>

</DefaultLayout>

<style>
    /* ç®€å•çš„é¡µé¢å†…æ ·å¼ï¼Œç”¨äºå¿«é€ŸéªŒè¯ */

    section {
        margin-bottom: 4rem;
        padding: 0 1rem;
    }

    /* Hero æ ·å¼ */
    .hero {
        text-align: center;
        padding: 4rem 1rem;
        background: linear-gradient(to bottom, transparent, rgba(var(--gray), 0.1));
        border-radius: 1rem;
    }
    .hero h1 {
        font-size: 2.5rem;
        margin-bottom: 0.5em;
    }
    .hero-actions {
        margin-top: 2rem;
        display: flex;
        gap: 1rem;
        justify-content: center;
    }

    /* æŒ‰é’®æ ·å¼ */
    .btn {
        padding: 0.5rem 1.5rem;
        border-radius: 999px;
        text-decoration: none;
        font-weight: bold;
        transition: all 0.2s;
    }
    .btn-primary {
        background: #2d3748;
        color: white;
    }
    .btn-outline {
        border: 2px solid #2d3748;
        color: #2d3748;
    }
    .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    /* æ–‡ç« å¡ç‰‡ç½‘æ ¼ */
    .post-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 1.5rem;
        margin-top: 1.5rem;
    }
    .post-card {
        display: block;
        padding: 1.5rem;
        border: 1px solid rgba(var(--gray), 0.2);
        border-radius: 8px;
        text-decoration: none;
        color: inherit;
        transition: border-color 0.2s;
    }
    .post-card:hover {
        border-color: #2d3748;
    }
    .post-card h3 {
        margin: 0 0 0.5rem 0;
        font-size: 1.25rem;
    }
    .post-card .date {
        font-size: 0.85rem;
        color: #666;
        margin-bottom: 0.5rem;
    }
    .post-card .desc {
        margin: 0;
        font-size: 0.95rem;
        line-height: 1.4;
    }

    .long-content-test {
        border-top: 1px dashed #ccc;
        padding-top: 2rem;
    }
</style>

---
// src/components/TableOfContents.astro

/**
 * TableOfContents
 * This component generates a table of contents based on the headings provided in the props.
 * It filters out H1 (depth 1) and any headings deeper than H3 (depth > 3) to maintain a clean and concise TOC.
 * Each entry in the TOC links to the corresponding section in the page using anchor links.
 * If there are no valid headings, it displays a message indicating that there are no contents.
 * Props:
 * - headings: An array of heading objects, each containing `depth`, `text`, and `slug` properties.
 * Usage:
 * <TableOfContents headings={headings} />
 */

const { headings } = Astro.props;

// Filter out H1 (depth 1) and any headings deeper than H3 (depth > 3)
const toc = (headings || []).filter((h: any) => h.depth > 1 && h.depth < 4);
---

{
    toc.length > 0 ? (
        <nav class="toc-nav">
            <ul class="space-y-2">
                {toc.map((heading: any) => (
                    <li class={`toc-item depth-${heading.depth}`}>
                        <a
                            href={`#${heading.slug}`}
                            class="block text-sm text-gray-500 hover:text-[#2d3748] transition-colors duration-200 truncate"
                            title={heading.text}
                        >
                            {heading.text}
                        </a>
                    </li>
                ))}
            </ul>
        </nav>
    ) : (
        <p class="text-xs text-gray-400 italic">No contents</p>
    )
}

<style>
    .depth-3 {
        padding-left: 1rem;
        font-size: 0.8rem;
    }
</style>
